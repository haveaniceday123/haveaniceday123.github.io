I"–t<h2 id="è¾—è½¬ç›¸é™¤æ³•">è¾—è½¬ç›¸é™¤æ³•</h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ll</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">b</span> <span class="o">?</span> <span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">%</span> <span class="n">b</span><span class="p">)</span> <span class="o">:</span> <span class="n">a</span><span class="p">;</span> <span class="p">}</span> <span class="c1">//aã€bçš„æœ€å¤§å…¬çº¦æ•°</span>
<span class="n">ll</span> <span class="nf">lcm</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">gcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="n">b</span><span class="p">;</span> <span class="p">}</span>	 <span class="c1">//aã€bçš„æœ€å°å…¬å€æ•°</span>
<span class="n">ll</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">,</span> <span class="n">ll</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="n">ll</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">)</span>					 <span class="c1">//æ‰©å±•æ¬§å‡ é‡Œå¾—ï¼Œå¼•ç”¨è¿”å›a*x+b*y=gcd(a,b)ç»å¯¹å€¼ä¹‹å’Œæœ€å°çš„è§£</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">a</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
	<span class="n">ll</span> <span class="n">d</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">b</span> <span class="o">%</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">x</span> <span class="o">-=</span> <span class="n">b</span> <span class="o">/</span> <span class="n">a</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">d</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">ll</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">)</span> <span class="c1">//æ— å–æ¨¡æ±‚gcd</span>
<span class="p">{</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">ll</span> <span class="n">t</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">;;)</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">t</span> <span class="o">*</span> <span class="n">a</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)</span>
			<span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
			<span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">a</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
			<span class="n">d</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">b</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">&amp;&amp;</span> <span class="n">d</span><span class="p">)</span>
			<span class="n">t</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">c</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">d</span><span class="p">)</span>
			<span class="n">a</span> <span class="o">-=</span> <span class="n">b</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="è£´èœ€å®šç†">è£´èœ€å®šç†</h3>

<p>å¯¹ä»»ä½•$a,b\in Z$å’Œå®ƒä»¬çš„æœ€å¤§å…¬çº¦æ•°$d$ï¼Œå…³äºæœªçŸ¥æ•°$x,y$çš„çº¿æ€§ä¸å®šæ–¹ç¨‹ï¼ˆç§°ä¸ºè£´èœ€ç­‰å¼ï¼‰ï¼š$ax+by=c$å½“ä»…å½“$d\vert c$ï¼Œå¯çŸ¥æœ‰æ— ç©·å¤šè§£ã€‚ç‰¹åˆ«åœ°ï¼Œ$ax+by=d$ä¸€å®šæœ‰è§£ã€‚</p>

<h4 id="æ¨è®º">æ¨è®º</h4>

<p>$a,b$äº’è´¨çš„å……è¦æ¡ä»¶æ˜¯$ax+by=1$æœ‰æ•´æ•°è§£ã€‚</p>

<h2 id="åŒä½™ç³»è¿ç®—">åŒä½™ç³»è¿ç®—</h2>

<p>ä¸‰ç§ä¹˜æ³•çš„æ¯”è¾ƒï¼Œç»“è®ºæ˜¯å¦‚æœå¯ä»¥ç”¨<code class="language-plaintext highlighter-rouge">__int128</code>å°±ç”¨ï¼Œå¦åˆ™å°±ç”¨ç¬¬ä¸€ç§ï¼š</p>

<ul>
  <li><a href="https://vjudge.net/solution/19521824">ä½¿ç”¨<code class="language-plaintext highlighter-rouge">__int128</code></a></li>
  <li><a href="https://vjudge.net/solution/19853184">ç¬¬ä¸€ç§åŒä½™ä¹˜æ³•</a></li>
  <li><a href="https://vjudge.net/solution/19521800">ç¬¬äºŒç§åŒä½™ä¹˜æ³•</a></li>
</ul>

<p>æ±‚ä¹˜æ³•é€†å…ƒçš„å¦å¤–ä¸€ç§æ–¹æ³•æ˜¯ç”¨æ¬§æ‹‰å®šç†$x^{\phi(m)}\equiv1\pmod m$ï¼Œx çš„é€†æ˜¯$x^{\phi(m)-1}$ã€‚ç‰¹åˆ«åœ°ï¼Œm ä¸ºç´ æ•°æ—¶$\phi(m)=m-1$ï¼Œæ­¤æ—¶ x çš„é€†å°±æ˜¯<code class="language-plaintext highlighter-rouge">pow(x,m-2,m)</code>ã€‚</p>

<p>log å‡½æ•°ï¼šm ä¸ºç´ æ•°æ—¶<a href="https://vjudge.net/solution/19395246">æ±‚è§£æ¨¡æ–¹ç¨‹</a>$a^x\equiv b\pmod m$ã€‚è®¾ P ä¸ºè´¨æ•°ï¼ŒG ä¸º P çš„åŸæ ¹ï¼Œåˆ™$x^y\equiv b\pmod P$ç­‰ä»·äº$y\ ind\ x\equiv b\pmod{P-1}$ï¼Œå…¶ä¸­$G\ ind\ x\equiv x\pmod P$ã€‚</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="nc">Mod</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="n">ll</span> <span class="n">M</span><span class="p">,</span> <span class="n">SM</span><span class="p">;</span>
	<span class="n">Mod</span><span class="p">(</span><span class="n">ll</span> <span class="n">M</span><span class="p">)</span> <span class="o">:</span> <span class="n">M</span><span class="p">(</span><span class="n">M</span><span class="p">),</span> <span class="n">SM</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="p">{}</span>
	<span class="n">ll</span> <span class="n">qadd</span><span class="p">(</span><span class="n">ll</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">a</span> <span class="o">+=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">&gt;=</span> <span class="n">M</span> <span class="o">?</span> <span class="n">a</span> <span class="o">-=</span> <span class="n">M</span> <span class="o">:</span> <span class="n">a</span><span class="p">;</span> <span class="p">}</span> <span class="c1">//å‡å¦‚a+b&lt;2*Mï¼Œå°±ä¸å¿…å–æ¨¡äº†ï¼Œå–æ¨¡è¿ç®—è€—æ—¶å¾ˆé«˜</span>
	<span class="n">ll</span> <span class="n">add</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">qadd</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span><span class="p">,</span> <span class="n">M</span><span class="p">);</span> <span class="p">}</span>	  <span class="c1">//è€ƒè™‘aå’Œbä¸åœ¨åŒä½™ç³»å†…ç”šè‡³ä¸ºè´Ÿæ•°çš„æƒ…å†µ</span>
	<span class="n">ll</span> <span class="n">mul</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">add</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">,</span> <span class="n">M</span><span class="p">);</span> <span class="p">}</span>
	<span class="n">ll</span> <span class="n">inv</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">pow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span> <span class="p">}</span> <span class="c1">//è¦æ±‚Mä¸ºç´ æ•°ï¼Œå¦åˆ™return pow(a, phi(M) - 1);</span>
	<span class="n">ll</span> <span class="n">pow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">)</span> <span class="k">const</span>
	<span class="p">{</span>
		<span class="n">ll</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="cm">/*
		if (b &lt; 0)
			b = -b, a = inv(a);
		*/</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">M</span><span class="p">);</span> <span class="n">b</span><span class="p">;</span> <span class="n">b</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
				<span class="n">r</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">r</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="cm">/*
	ll mul(ll a, ll b) const { return add(a * b, -M * (ll)((long double)a / M * b)); } //long double æœ‰æ•ˆä½æ•°16~18ä½ï¼Œæ¨¡æ•°è¿‡å¤§æ—¶æ…ç”¨ï¼
	ll mul(ll a, ll b) const //Headç®—æ³•ï¼Œæ— å¾ªç¯å¿«é€Ÿè®¡ç®—åŒä½™ä¹˜æ³•ï¼Œæ ¹æ®a*bæ˜¯å¦çˆ†llæ›¿æ¢a*b%Mï¼Œéœ€è¦a&lt;Mä¸”b&lt;Mï¼Œå¯ä»¥è°ƒç”¨æ—¶æ‰‹åŠ¨å–æ¨¡
	{
		ll c = a / SM, d = b / SM;
		a %= SM, b %= SM;
		ll e = add(add(a * d, b * c), c * d / SM * (SM * SM - M));
		return add(add(a * b, e % SM * SM), add(c * d % SM, e / SM) * (SM * SM - M));
	}
	ll mul(ll a, ll b) const //é¾Ÿé€Ÿä¹˜
	{
		ll r = 0;
		for (a %= M; b; b &gt;&gt;= 1, qadd(a, a))
			if (b &amp; 1)
				qadd(r, a);
		return r;
	}
	ll inv(ll a) const //æ¨¡mä¸‹açš„ä¹˜æ³•é€†å…ƒï¼Œä¸å­˜åœ¨è¿”å›-1ï¼ˆmä¸ºç´ æ•°æ—¶aä¸ä¸º0å¿…æœ‰é€†å…ƒï¼‰
	{
		ll x, y, d = gcd(a, M, x, y);
		return d == 1 ? add(x, M) : -1;
	}
	vector&lt;ll&gt; sol(ll a, ll b) const //è§£åŒä½™æ–¹ç¨‹ï¼Œè¿”å›ax=b(mod M)å¾ªç¯èŠ‚å†…æ‰€æœ‰è§£
	{
		vector&lt;ll&gt; ans;
		ll x, y, d = gcd(a, M, x, y);
		if (b % d)
			return ans;
		ans.push_back(mul((b / d) % (M / d), x));
		for (ll i = 1; i &lt; d; ++i)
			ans.push_back(add(ans.back(), M / d));
		return ans;
	}
	ll log(ll a, ll b) const
	{
		unordered_map&lt;ll, ll&gt; x;
		for (ll i = 0, e = 1; i &lt;= SM; ++i, e = mul(e, a))
			if (!x.count(e))
				x[e] = i;
		for (ll i = 0, v = inv(pow(a, SM)); i &lt;= SM; ++i, b = mul(b, v))
			if (x.count(b))
				return i * SM + x[b];
		return -1;
	}
	*/</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="ä¸­å›½å‰©ä½™å®šç†è§£åŒä½™æ–¹ç¨‹ç»„">ä¸­å›½å‰©ä½™å®šç†è§£åŒä½™æ–¹ç¨‹ç»„</h3>

<p><a href="https://vjudge.net/solution/14375815">ä½¿ç”¨ç¤ºä¾‹</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ll</span> <span class="nf">crt</span><span class="p">(</span><span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">ll</span><span class="p">,</span> <span class="n">ll</span><span class="o">&gt;&gt;</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">)</span> <span class="c1">//åŒä½™æ–¹ç¨‹ç»„ï¼Œx%v[i].first==v[i].secondï¼Œä¸å­˜åœ¨è¿”å›-1</span>
<span class="p">{</span>
	<span class="n">ll</span> <span class="n">m</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">first</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">second</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">second</span> <span class="o">-</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">c</span> <span class="o">%</span> <span class="n">d</span><span class="p">)</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">gcd</span><span class="p">(</span><span class="n">m</span> <span class="o">/</span> <span class="n">d</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">first</span> <span class="o">/</span> <span class="n">d</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">r</span> <span class="o">+=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">d</span> <span class="o">*</span> <span class="n">x</span> <span class="o">%</span> <span class="n">z</span> <span class="o">*</span> <span class="n">m</span><span class="p">,</span> <span class="n">r</span> <span class="o">%=</span> <span class="n">m</span> <span class="o">*=</span> <span class="n">z</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="n">r</span> <span class="o">+</span> <span class="n">m</span> <span class="o">:</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">struct</span> <span class="nc">Excrt</span>
<span class="p">{</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">b2</span><span class="p">,</span> <span class="n">a2</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">init</span><span class="p">()</span>
	<span class="p">{</span>
		<span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
		<span class="n">ll</span> <span class="n">q</span><span class="p">,</span> <span class="n">qq</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
			<span class="n">scanf</span><span class="p">(</span><span class="s">"%lld%lld"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">q</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">qq</span><span class="p">),</span> <span class="n">b2</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="n">a2</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">qq</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">ll</span> <span class="n">get</span><span class="p">()</span>
	<span class="p">{</span>
		<span class="n">ll</span> <span class="n">M</span><span class="p">,</span> <span class="n">ans</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">M</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">ll</span> <span class="n">a</span> <span class="o">=</span> <span class="n">M</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">a2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">ans</span> <span class="o">%</span> <span class="n">b</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">%</span> <span class="n">b</span><span class="p">;</span> <span class="c1">//ax=c(mod b)</span>
			<span class="n">ll</span> <span class="n">gcd</span> <span class="o">=</span> <span class="n">exgcd</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">bg</span> <span class="o">=</span> <span class="n">b</span> <span class="o">/</span> <span class="n">gcd</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="o">%</span> <span class="n">gcd</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span> <span class="c1">//è¿”å›-1è¡¨ç¤ºæ— è§£</span>
			<span class="n">x</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span> <span class="o">/</span> <span class="n">gcd</span><span class="p">,</span> <span class="n">bg</span><span class="p">);</span>
			<span class="n">y</span> <span class="o">=</span> <span class="n">M</span> <span class="o">/</span> <span class="n">gcd</span> <span class="o">*</span> <span class="n">b</span><span class="p">;</span>
			<span class="n">ans</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">M</span> <span class="o">+</span> <span class="n">ans</span><span class="p">)</span> <span class="o">%</span> <span class="n">y</span><span class="p">;</span> <span class="c1">//???k???????</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ans</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
				<span class="n">ans</span> <span class="o">+=</span> <span class="n">y</span><span class="p">;</span>
			<span class="n">M</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span> <span class="c1">//M??k?m?lcm</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="äºŒæ¬¡å‰©ä½™">äºŒæ¬¡å‰©ä½™</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="nc">QuadraticRes</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="nc">numb</span>
	<span class="p">{</span>
		<span class="n">ll</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span>
	<span class="p">};</span>
	<span class="n">numb</span> <span class="n">mul</span><span class="p">(</span><span class="k">const</span> <span class="n">numb</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">numb</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">,</span> <span class="n">ll</span> <span class="n">p</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="p">(</span><span class="n">numb</span><span class="p">){(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">b</span><span class="p">.</span><span class="n">x</span> <span class="o">%</span> <span class="n">p</span> <span class="o">+</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">%</span> <span class="n">p</span> <span class="o">*</span> <span class="n">w</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">b</span><span class="p">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">a</span><span class="p">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">b</span><span class="p">.</span><span class="n">x</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">};</span>
	<span class="p">}</span>
	<span class="n">ll</span> <span class="n">pow2</span><span class="p">(</span><span class="n">numb</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">b</span><span class="p">,</span> <span class="n">ll</span> <span class="n">p</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">numb</span> <span class="n">ret</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span> <span class="n">tem</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="n">b</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
				<span class="n">ret</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">tem</span><span class="p">,</span> <span class="n">p</span><span class="p">);</span>
			<span class="n">tem</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">tem</span><span class="p">,</span> <span class="n">tem</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="n">b</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="n">ret</span><span class="p">.</span><span class="n">x</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">ll</span> <span class="n">get</span><span class="p">(</span><span class="n">ll</span> <span class="n">n</span><span class="p">,</span> <span class="n">ll</span> <span class="n">p</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">Mod</span><span class="p">(</span><span class="n">p</span><span class="p">).</span><span class="n">pow</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span> <span class="c1">//æ­¤æ—¶æ— è§£</span>
		<span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">ll</span> <span class="n">a</span> <span class="o">=</span> <span class="n">rand</span><span class="p">();</span>
			<span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">a</span> <span class="o">-</span> <span class="n">n</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">Mod</span><span class="p">(</span><span class="n">p</span><span class="p">).</span><span class="n">pow</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">p</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="k">return</span> <span class="n">pow2</span><span class="p">((</span><span class="n">numb</span><span class="p">){</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span> <span class="n">p</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">);</span> <span class="c1">//è¿˜æœ‰ä¸€ä¸ªè§£æ˜¯på‡å»è¿™ä¸ªå€¼</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="æ¬§æ‹‰ç­›">æ¬§æ‹‰ç­›</h2>

<p>æ¬§æ‹‰å‡½æ•°$\phi(n)$æ˜¯å°äº n çš„æ­£æ•´æ•°ä¸­ä¸ n äº’ç´ çš„æ•°çš„æ•°ç›®ã€‚ç‰¹åˆ«åœ°ï¼Œè§„å®š$\phi(1)=1$ï¼Œæ˜“çŸ¥ n&gt;2 æ—¶éƒ½ä¸ºå¶æ•°ã€‚</p>

<p>æ¬§æ‹‰å‡½æ•°æ˜¯ç§¯æ€§å‡½æ•°ï¼Œå³å¯¹ä»»æ„ç´ æ•°$p,q$æ»¡è¶³ä¸‹åˆ—å…³ç³»ï¼š$\phi(pq)=\phi(p)\phi(q)=(p-1)(q-1)$å¯¹ä»»ä½•ä¸¤ä¸ªäº’è´¨çš„æ­£æ•´æ•°$x, m(m\geq2)$æœ‰æ¬§æ‹‰å®šç†ï¼š$x^{\phi(m)}\equiv1\pmod m$å½“ m ä¸ºç´ æ•° p æ—¶ï¼Œæ­¤å¼å˜ä¸ºè´¹é©¬å°å®šç†ï¼š$x^{p-1}\equiv1\pmod p$åˆ©ç”¨æ¬§æ‹‰å‡½æ•°å’Œå®ƒæœ¬èº«ä¸åŒè´¨å› æ•°çš„å…³ç³»ï¼Œç”¨ç­›æ³•$O(N)$é¢„å¤„ç†æŸä¸ªèŒƒå›´å†…æ‰€æœ‰æ•°çš„æ¬§æ‹‰å‡½æ•°å€¼ï¼Œå¹¶æ±‚å‡ºç´ æ•°è¡¨ã€‚åŒæ—¶ï¼Œåˆ©ç”¨è®¡ç®—æ¬§æ‹‰å‡½æ•°è¿‡ç¨‹ä¸­æ±‚å‡ºçš„æœ€å°ç´ å› å­ mï¼Œå¯ä»¥å®ç°$O(log N)$çš„ç´ å› æ•°åˆ†è§£ã€‚</p>

<p>åŒæ—¶æ±‚è«æ¯”ä¹Œæ–¯å‡½æ•°$\mu(n)$ï¼Œå­˜åœ¨<code class="language-plaintext highlighter-rouge">mu</code>ä¸­ã€‚</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="nc">EulerSieve</span>
<span class="p">{</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">p</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">mu</span><span class="p">;</span> <span class="c1">//ç´ æ•°åºåˆ—ï¼Œæœ€å°ç´ å› å­ï¼Œæ¬§æ‹‰å‡½æ•°ï¼Œè«æ¯”ä¹Œæ–¯å‡½æ•°</span>
	<span class="n">EulerSieve</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">)</span> <span class="o">:</span> <span class="n">m</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">phi</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">mu</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">phi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">mu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>					 <span class="c1">//m[1]=0,m[i]==iå¯åˆ¤æ–­iæ˜¯ç´ æ•°</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">k</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="c1">//é˜²i*p[j]çˆ†int</span>
		<span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
				<span class="n">p</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">),</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="c1">//iæ˜¯ç´ æ•°</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="n">phi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
				<span class="k">if</span> <span class="p">((</span><span class="n">m</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">==</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
				<span class="p">{</span>
					<span class="n">mu</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">phi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-=</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
				<span class="n">mu</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">mu</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="ç›´æ¥æ±‚æ¬§æ‹‰å‡½æ•°"><a href="https://vjudge.net/solution/19396361">ç›´æ¥æ±‚æ¬§æ‹‰å‡½æ•°</a></h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ll</span> <span class="nf">phi</span><span class="p">(</span><span class="n">ll</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ll</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">ll</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">*</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">i</span><span class="p">))</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">phi</span> <span class="o">=</span> <span class="n">phi</span> <span class="o">/</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span> <span class="o">!</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">i</span><span class="p">);)</span>
				<span class="n">n</span> <span class="o">/=</span> <span class="n">i</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">phi</span> <span class="o">=</span> <span class="n">phi</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">phi</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="å¸¸è§æ•°è®ºå‡½æ•°å˜æ¢">å¸¸è§æ•°è®ºå‡½æ•°å˜æ¢</h3>

<p>$\sum_{d\vert n}\mu(d)=[n=1]$</p>

<p>$\phi(n)=\sum_{i=1}^n[\gcd(i,n)=1]=\sum_{i=1}^n\sum_{k\mid i,k\mid n}\mu(k)=\sum_{k\mid n}\frac nk\mu(k)$</p>

<h4 id="å‰ç¼€å’Œ">å‰ç¼€å’Œ</h4>

<p>æ¬§æ‹‰å‡½æ•°å‰ç¼€å’Œ$S_\phi(n)=\frac{(n+1)n}2-\sum_{d=1}^nS_\phi(\frac{n}{d})$</p>

<p>è«æ¯”ä¹Œæ–¯å‡½æ•°å‰ç¼€å’Œ$S_\mu(n)=1-\sum_{d=1}^nS_\mu(\frac{n}{d})$</p>

<h4 id="è«æ¯”ä¹Œæ–¯åæ¼”">è«æ¯”ä¹Œæ–¯åæ¼”</h4>

<p>è‹¥$f(n)=\sum_{d\vert n}g(d)$ï¼Œåˆ™$g(n)=\sum_{d\vert n}\mu(d)f(\frac{n}{d})$</p>

<p>è‹¥$f(n)=\sum_{i=1}^nt(i)g(\frac{n}{i})$ï¼Œåˆ™$g(n)=\sum_{i=1}^n\mu(i)t(i)f(\frac{n}{i})$ï¼ˆæ­¤æ—¶ä»£$t(i)=[gcd(n,i)&gt;1]$å¯å¾—ä¸Šå¼ï¼‰</p>

<p>ä¸¾ä¾‹ï¼ˆå…¶ä¸­$T=kd$ï¼‰ï¼š</p>

\[\sum_{i=1}^n\sum_{j=1}^m\gcd(i,j)\\
=\sum_d d\sum_{i=1}^n\sum_{j=1}^m[\gcd (i,j)=d]\\
=\sum_{d}d\sum_{i=1}^{\lfloor\frac nd\rfloor}\sum_{j=1}^{\lfloor\frac md\rfloor}[\gcd (i,j)=1]\\
=\sum_{d}d\sum_{i=1}^{\lfloor\frac nd\rfloor}\sum_{j=1}^{\lfloor\frac md\rfloor}\sum_{k\mid i,k\mid j}\mu(k)\\
=\sum_d d\sum_k\mu(k)\sum_{k\mid i}^{\lfloor\frac nd\rfloor}\sum_{k\mid j}^{\lfloor\frac md\rfloor}\\
=\sum_{d}d\sum_k\mu(k)\lfloor\frac n{kd}\rfloor\lfloor\frac m{kd}\rfloor\\
=\sum_{T}\lfloor\frac nT\rfloor\lfloor\frac mT\rfloor\sum_{k\mid T}\frac Tk\mu(k)\\
=\sum_{T}\lfloor\frac nT\rfloor\lfloor\frac mT\rfloor\varphi(T)\]

<p>$\varphi(T)$å¯ä»¥ä½¿ç”¨çº¿æ€§ç­›é¢„å¤„ç†å¤„ç†ï¼Œæˆ‘ä»¬å°±å¯ä»¥æšä¸¾$T$æ±‚ä¸Šå¼äº†ï¼Œæ—¶é—´å¤æ‚åº¦$O(n)$ã€‚å¤šç»„æ•°æ®$n,m$è¯¢é—®ä¸Šå¼ï¼Œæ—¶é—´å¤æ‚åº¦å°±å˜æˆäº†$O(Tn)$ã€‚äº‹å®ä¸Šï¼Œ$\lfloor\frac{n}{T}\rfloor$æ˜¯ä¸ä¼šè½»æ˜“å˜åŒ–çš„ï¼Œæ˜¯è¿‡äº†è¿ç»­çš„ä¸€æ®µåæ‰å‘ç”Ÿå˜åŒ–çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è®¡ç®—å‡ºè¿™ä¸€æ®µçš„ç»“æŸä½ç½®ï¼Œå¯¹$\varphi$å‡½æ•°ä½œå‰ç¼€å’Œï¼Œå°±å¯ä»¥ç›´æ¥åˆ†å—äº†ï¼Œè¿™æ ·çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(T\sqrt{n})$çš„ã€‚</p>

<h2 id="pollardrho-å¤§æ•°ç´ å› å­åˆ†è§£">PollardRho å¤§æ•°ç´ å› å­åˆ†è§£</h2>

<p>æ—¶é—´å¤æ‚åº¦$O(N^{1/4})$ï¼Œæ•°æ®å¤šçš„æ—¶å€™å¯è€ƒè™‘æ¬§æ‹‰ç­›ä¼˜åŒ–ã€‚</p>

<p>æ³¨æ„è¿™é‡Œæ¨¡ä¹˜æ³•å¾ˆå®¹æ˜“çˆ† long longï¼Œçœ‹æƒ…å†µé€‰ç”¨å¿«é€Ÿä¹˜æ³•ã€‚</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="nc">PollardRho</span>
<span class="p">{</span>
	<span class="kt">bool</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">ll</span> <span class="n">n</span><span class="p">,</span> <span class="kt">int</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span> <span class="c1">//MillerRabinç´ æ•°æµ‹è¯•ï¼ŒSä¸ºæµ‹è¯•æ¬¡æ•°ï¼Œç”¨å‰Sä¸ªç´ æ•°æµ‹ä¸€éï¼ŒS=12å¯ä¿è¯unsigned long longèŒƒå›´å†…æ— é”™ï¼›n&lt;2è¯·ç‰¹åˆ¤</span>
	<span class="p">{</span>
		<span class="k">static</span> <span class="n">ll</span> <span class="n">d</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">};</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">d</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="o">!</span><span class="p">(</span><span class="n">d</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">);)</span>
			<span class="n">d</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">//æœªå¯¹0ï¼Œ1åšç‰¹åˆ¤ï¼</span>
		<span class="n">Mod</span> <span class="n">mo</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">S</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
				<span class="k">return</span> <span class="n">n</span> <span class="o">==</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">t</span> <span class="o">=</span> <span class="n">mo</span><span class="p">.</span><span class="n">pow</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">u</span> <span class="o">=</span> <span class="n">d</span><span class="p">);</span> <span class="n">t</span> <span class="o">!=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">t</span> <span class="o">!=</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">u</span> <span class="o">!=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;)</span>
				<span class="n">t</span> <span class="o">=</span> <span class="n">mo</span><span class="p">.</span><span class="n">mul</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="n">u</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">!=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">u</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">))</span>
				<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="kt">void</span> <span class="n">fac</span><span class="p">(</span><span class="n">ll</span> <span class="n">n</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">factor</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="cm">/*
		if (n &lt; e.m.size()) //æ¬§æ‹‰ç­›é¢„å¤„ç†ä¼˜åŒ–ï¼Œå¯ä»¥é˜²æ­¢å¾ˆå¤šå°ç´ æ•°å› å­çš„æƒ…å†µ
		{
			for (; n &gt; 1; n /= e.m[n])
				factor.push_back(e.m[n]);
			return;
		}
		*/</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">isPrime</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
			<span class="k">return</span> <span class="n">factor</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
		<span class="n">Mod</span> <span class="n">mo</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">ll</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;;</span> <span class="o">++</span><span class="n">c</span><span class="p">)</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">ll</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">;;)</span>
			<span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">++</span><span class="n">i</span> <span class="o">==</span> <span class="n">k</span><span class="p">)</span>
					<span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">k</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">mo</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">mo</span><span class="p">.</span><span class="n">mul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">c</span><span class="p">),</span> <span class="n">p</span> <span class="o">=</span> <span class="n">__gcd</span><span class="p">(</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">),</span> <span class="n">n</span><span class="p">),</span> <span class="n">p</span> <span class="o">==</span> <span class="n">n</span><span class="p">)</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">p</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
					<span class="k">return</span> <span class="n">fac</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">factor</span><span class="p">),</span> <span class="n">fac</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">p</span><span class="p">,</span> <span class="n">factor</span><span class="p">);</span>
			<span class="p">}</span>
	<span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="å¿«é€Ÿå˜æ¢">å¿«é€Ÿå˜æ¢</h2>

<h3 id="è´è¶å˜æ¢é›·å¾·å˜æ¢">è´è¶å˜æ¢ï¼ˆé›·å¾·å˜æ¢ï¼‰</h3>

<p>ä¿å­˜ FTT å’Œ FNTT æ—¶äº¤æ¢çš„å¯¹åº”ä½ç½®ï¼ˆå³ä¿å­˜çš„æ˜¯ç½®æ¢ï¼‰ã€‚</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="nc">Rader</span> <span class="o">:</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span>
<span class="p">{</span>
	<span class="n">Rader</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="o">:</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="kt">int</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">log2</span><span class="p">(</span><span class="n">n</span><span class="p">))))</span>
	<span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
				<span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+=</span> <span class="n">size</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="å¿«é€Ÿå‚…é‡Œå¶å˜æ¢">å¿«é€Ÿå‚…é‡Œå¶å˜æ¢</h3>

<p><a href="https://vjudge.net/solution/21912936">ä½¿ç”¨ç¤ºä¾‹</a>ï¼Œé«˜ç²¾åº¦ä¹˜æ³•ã€‚</p>

<p><a href="https://vjudge.net/solution/21914340">ä»»æ„æ¨¡æ•° FFT</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="nc">FFT</span> <span class="o">:</span> <span class="n">Rader</span>
<span class="p">{</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="n">w</span><span class="p">;</span>
	<span class="n">FFT</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="o">:</span> <span class="n">Rader</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">size</span><span class="p">())</span>
	<span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">polar</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">M_PI</span> <span class="o">*</span> <span class="n">i</span> <span class="o">/</span> <span class="n">size</span><span class="p">());</span>
	<span class="p">}</span>
	<span class="kt">void</span> <span class="n">fft</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">)</span> <span class="k">const</span>
	<span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
				<span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)]);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="n">i</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">)</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
				<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="n">k</span> <span class="o">+=</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">size</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">i</span><span class="p">];</span>
					<span class="n">x</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">t</span><span class="p">;</span>
				<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">ask</span><span class="p">(</span><span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span> <span class="k">const</span>
	<span class="p">{</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="n">xa</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">a</span><span class="p">.</span><span class="n">end</span><span class="p">()),</span> <span class="n">xb</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">b</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
		<span class="n">xa</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">size</span><span class="p">()),</span> <span class="n">xb</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">size</span><span class="p">()),</span> <span class="n">fft</span><span class="p">(</span><span class="n">xa</span><span class="p">),</span> <span class="n">fft</span><span class="p">(</span><span class="n">xb</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">xa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="n">xb</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">fft</span><span class="p">(</span><span class="n">xa</span><span class="p">);</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">ans</span><span class="p">(</span><span class="n">size</span><span class="p">());</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xa</span><span class="p">[(</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)].</span><span class="n">real</span><span class="p">()</span> <span class="o">/</span> <span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">;</span>
		<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">askMod</span><span class="p">(</span><span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">,</span> <span class="n">ll</span> <span class="n">M</span><span class="p">)</span> <span class="k">const</span> <span class="c1">//ä»»æ„æ¨¡æ•°</span>
	<span class="p">{</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="n">e</span><span class="p">(</span><span class="n">size</span><span class="p">()),</span> <span class="n">c</span><span class="p">(</span><span class="n">size</span><span class="p">());</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">real</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x7fff</span><span class="p">),</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">imag</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">15</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">real</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x7fff</span><span class="p">),</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">imag</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">15</span><span class="p">);</span>
		<span class="n">fft</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">fft</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="n">d</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="kt">int</span> <span class="n">fr</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">X</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="n">fr</span><span class="p">].</span><span class="n">X</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Y</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">fr</span><span class="p">].</span><span class="n">Y</span><span class="p">);</span>
			<span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">Y</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="n">fr</span><span class="p">].</span><span class="n">Y</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="n">fr</span><span class="p">].</span><span class="n">X</span> <span class="o">-</span> <span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">X</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">fft</span><span class="p">(</span><span class="n">c</span><span class="p">),</span> <span class="n">fft</span><span class="p">(</span><span class="n">d</span><span class="p">);</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">ans</span><span class="p">(</span><span class="n">size</span><span class="p">());</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">ll</span> <span class="n">fr</span> <span class="o">=</span> <span class="p">(</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
			   <span class="n">p</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">fr</span><span class="p">].</span><span class="n">X</span> <span class="o">/</span> <span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span>
			   <span class="n">o</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="n">fr</span><span class="p">].</span><span class="n">Y</span> <span class="o">/</span> <span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span>
			   <span class="n">x</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">fr</span><span class="p">].</span><span class="n">X</span> <span class="o">/</span> <span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span>
			   <span class="n">u</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">fr</span><span class="p">].</span><span class="n">Y</span> <span class="o">/</span> <span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">;</span>
			<span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">%</span> <span class="n">M</span> <span class="o">+</span> <span class="p">((</span><span class="n">o</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span> <span class="o">&lt;&lt;</span> <span class="mi">15</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">u</span> <span class="o">%</span> <span class="n">M</span> <span class="o">&lt;&lt;</span> <span class="mi">30</span><span class="p">))</span> <span class="o">%</span> <span class="n">M</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="å¿«é€Ÿæ•°è®ºå˜æ¢">å¿«é€Ÿæ•°è®ºå˜æ¢</h3>

<p>åŸç†å’Œ FFT ç›¸åŒï¼Œè§£å†³ç‰¹æ®Šæƒ…å†µä¸‹ FFT çš„æµ®ç‚¹è¯¯å·®ï¼Œå¹¶ä¸”å¯ä»¥åœ¨åŒä½™ç³»è¿›è¡Œå˜æ¢ã€‚</p>

<p>å¯¹äºå½¢å¦‚$m=2^nc+1$çš„è´¹é©¬ç´ æ•°ï¼Œè®°å…¶åŸæ ¹ä¸º gï¼Œåˆ™æ—‹è½¬å› å­ä¸º$g^{(m-1)/n}$ï¼Œæ»¡è¶³$g^{m-1}=1$ä¸”$2^n\mid m-1$ã€‚</p>

<p><a href="https://vjudge.net/solution/21913390">ä½¿ç”¨ç¤ºä¾‹</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="nc">FNTT</span> <span class="o">:</span> <span class="n">Rader</span><span class="p">,</span> <span class="n">Mod</span>
<span class="p">{</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">w</span><span class="p">;</span>
	<span class="n">FNTT</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span> <span class="n">ll</span> <span class="n">M</span><span class="p">,</span> <span class="n">ll</span> <span class="n">G</span><span class="p">)</span> <span class="o">:</span> <span class="n">Rader</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">Mod</span><span class="p">(</span><span class="n">M</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">size</span><span class="p">(),</span> <span class="n">pow</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="p">(</span><span class="n">M</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">size</span><span class="p">()))</span>
	<span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]);</span>
	<span class="p">}</span>
	<span class="kt">void</span> <span class="n">fntt</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">)</span> <span class="k">const</span>
	<span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
				<span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)]);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="n">i</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">)</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
				<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="n">k</span> <span class="o">+=</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="n">ll</span> <span class="n">t</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="n">size</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">j</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">i</span><span class="p">]);</span>
					<span class="n">qadd</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">M</span> <span class="o">-</span> <span class="n">t</span><span class="p">),</span> <span class="n">qadd</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">t</span><span class="p">);</span>
				<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">ask</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="k">const</span>
	<span class="p">{</span>
		<span class="n">a</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">size</span><span class="p">()),</span> <span class="n">b</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">size</span><span class="p">()),</span> <span class="n">fntt</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">fntt</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
		<span class="n">fntt</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">reverse</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
		<span class="n">ll</span> <span class="n">u</span> <span class="o">=</span> <span class="n">inv</span><span class="p">(</span><span class="n">size</span><span class="p">());</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">u</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">a</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h4 id="å¸¸è§ç´ æ•°çš„åŸæ ¹"><a href="https://blog.csdn.net/hnust_xx/article/details/76572828">å¸¸è§ç´ æ•°çš„åŸæ ¹</a></h4>

<table>
  <thead>
    <tr>
      <th>r * 2 ^ k + 1</th>
      <th>r</th>
      <th>k</th>
      <th>gï¼Œmod(r * 2 ^ k + 1)çš„åŸæ ¹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <td>5</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <td>17</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <td>97</td>
      <td>3</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <td>193</td>
      <td>3</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <td>257</td>
      <td>1</td>
      <td>8</td>
      <td>3</td>
    </tr>
    <tr>
      <td>7681</td>
      <td>15</td>
      <td>9</td>
      <td>17</td>
    </tr>
    <tr>
      <td>12289</td>
      <td>3</td>
      <td>12</td>
      <td>11</td>
    </tr>
    <tr>
      <td>40961</td>
      <td>5</td>
      <td>13</td>
      <td>3</td>
    </tr>
    <tr>
      <td>65537</td>
      <td>1</td>
      <td>16</td>
      <td>3</td>
    </tr>
    <tr>
      <td>786433</td>
      <td>3</td>
      <td>18</td>
      <td>10</td>
    </tr>
    <tr>
      <td>5767169</td>
      <td>11</td>
      <td>19</td>
      <td>3</td>
    </tr>
    <tr>
      <td>7340033</td>
      <td>7</td>
      <td>20</td>
      <td>3</td>
    </tr>
    <tr>
      <td>23068673</td>
      <td>11</td>
      <td>21</td>
      <td>3</td>
    </tr>
    <tr>
      <td>104857601</td>
      <td>25</td>
      <td>22</td>
      <td>3</td>
    </tr>
    <tr>
      <td>167772161</td>
      <td>5</td>
      <td>25</td>
      <td>3</td>
    </tr>
    <tr>
      <td>469762049</td>
      <td>7</td>
      <td>26</td>
      <td>3</td>
    </tr>
    <tr>
      <td>998244353</td>
      <td>119</td>
      <td>23</td>
      <td>3</td>
    </tr>
    <tr>
      <td>1004535809</td>
      <td>479</td>
      <td>21</td>
      <td>3</td>
    </tr>
    <tr>
      <td>2013265921</td>
      <td>15</td>
      <td>27</td>
      <td>31</td>
    </tr>
    <tr>
      <td>2281701377</td>
      <td>17</td>
      <td>27</td>
      <td>3</td>
    </tr>
    <tr>
      <td>3221225473</td>
      <td>3</td>
      <td>30</td>
      <td>5</td>
    </tr>
    <tr>
      <td>75161927681</td>
      <td>35</td>
      <td>31</td>
      <td>3</td>
    </tr>
    <tr>
      <td>77309411329</td>
      <td>9</td>
      <td>33</td>
      <td>7</td>
    </tr>
    <tr>
      <td>206158430209</td>
      <td>3</td>
      <td>36</td>
      <td>22</td>
    </tr>
    <tr>
      <td>2061584302081</td>
      <td>15</td>
      <td>37</td>
      <td>7</td>
    </tr>
    <tr>
      <td>2748779069441</td>
      <td>5</td>
      <td>39</td>
      <td>3</td>
    </tr>
    <tr>
      <td>6597069766657</td>
      <td>3</td>
      <td>41</td>
      <td>5</td>
    </tr>
    <tr>
      <td>39582418599937</td>
      <td>9</td>
      <td>42</td>
      <td>5</td>
    </tr>
    <tr>
      <td>79164837199873</td>
      <td>9</td>
      <td>43</td>
      <td>5</td>
    </tr>
    <tr>
      <td>263882790666241</td>
      <td>15</td>
      <td>44</td>
      <td>7</td>
    </tr>
    <tr>
      <td>1231453023109121</td>
      <td>35</td>
      <td>45</td>
      <td>3</td>
    </tr>
    <tr>
      <td>1337006139375617</td>
      <td>19</td>
      <td>46</td>
      <td>3</td>
    </tr>
    <tr>
      <td>3799912185593857</td>
      <td>27</td>
      <td>47</td>
      <td>5</td>
    </tr>
    <tr>
      <td>4222124650659841</td>
      <td>15</td>
      <td>48</td>
      <td>19</td>
    </tr>
    <tr>
      <td>7881299347898369</td>
      <td>7</td>
      <td>50</td>
      <td>6</td>
    </tr>
    <tr>
      <td>31525197391593473</td>
      <td>7</td>
      <td>52</td>
      <td>3</td>
    </tr>
    <tr>
      <td>180143985094819841</td>
      <td>5</td>
      <td>55</td>
      <td>6</td>
    </tr>
    <tr>
      <td>1945555039024054273</td>
      <td>27</td>
      <td>56</td>
      <td>5</td>
    </tr>
    <tr>
      <td>4179340454199820289</td>
      <td>29</td>
      <td>57</td>
      <td>3</td>
    </tr>
  </tbody>
</table>

<h3 id="å¿«é€Ÿæ²ƒå°”ä»€å˜æ¢">å¿«é€Ÿæ²ƒå°”ä»€å˜æ¢</h3>

<p>å¦‚æœè¦åœ¨åŒä½™ç³»ä¸­è¿›è¡Œè¿ç®—ï¼Œåˆ™ä¸‹é¢ä»£ç éœ€è¦ä¿®æ”¹ã€‚</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">fwt</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="kt">void</span> <span class="n">f</span><span class="p">(</span><span class="n">ll</span> <span class="o">&amp;</span><span class="n">l</span><span class="p">,</span> <span class="n">ll</span> <span class="o">&amp;</span><span class="n">r</span><span class="p">))</span>
<span class="p">{</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">i</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">)</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">k</span> <span class="o">+=</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span>
				<span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">i</span><span class="p">]);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">fwt</span><span class="p">(</span><span class="n">ll</span> <span class="o">*</span><span class="n">b</span><span class="p">,</span> <span class="n">ll</span> <span class="o">*</span><span class="n">e</span><span class="p">,</span> <span class="kt">void</span> <span class="n">f</span><span class="p">(</span><span class="n">ll</span> <span class="o">&amp;</span><span class="n">l</span><span class="p">,</span> <span class="n">ll</span> <span class="o">&amp;</span><span class="n">r</span><span class="p">))</span> <span class="c1">//å†ç»™ä¸€ä¸ªé€’å½’äºŒåˆ†çš„ä»£ç ä¾¿äºç†è§£</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="n">ll</span> <span class="o">*</span><span class="n">m</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
	<span class="n">fwt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">f</span><span class="p">),</span> <span class="n">fwt</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">m</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">)</span>
		<span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">b</span><span class="o">++</span><span class="p">),</span> <span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="o">++</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="and">AND</h4>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">tf</span><span class="p">(</span><span class="n">ll</span> <span class="o">&amp;</span><span class="n">l</span><span class="p">,</span> <span class="n">ll</span> <span class="o">&amp;</span><span class="n">r</span><span class="p">)</span> <span class="p">{</span> <span class="n">l</span> <span class="o">+=</span> <span class="n">r</span><span class="p">;</span> <span class="p">}</span>
<span class="kt">void</span> <span class="nf">utf</span><span class="p">(</span><span class="n">ll</span> <span class="o">&amp;</span><span class="n">l</span><span class="p">,</span> <span class="n">ll</span> <span class="o">&amp;</span><span class="n">r</span><span class="p">)</span> <span class="p">{</span> <span class="n">l</span> <span class="o">-=</span> <span class="n">r</span><span class="p">;</span> <span class="p">}</span>
</code></pre></div></div>

<h4 id="or">OR</h4>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">tf</span><span class="p">(</span><span class="n">ll</span> <span class="o">&amp;</span><span class="n">l</span><span class="p">,</span> <span class="n">ll</span> <span class="o">&amp;</span><span class="n">r</span><span class="p">)</span> <span class="p">{</span> <span class="n">r</span> <span class="o">+=</span> <span class="n">l</span><span class="p">;</span> <span class="p">}</span>
<span class="kt">void</span> <span class="nf">utf</span><span class="p">(</span><span class="n">ll</span> <span class="o">&amp;</span><span class="n">l</span><span class="p">,</span> <span class="n">ll</span> <span class="o">&amp;</span><span class="n">r</span><span class="p">)</span> <span class="p">{</span> <span class="n">r</span> <span class="o">-=</span> <span class="n">l</span><span class="p">;</span> <span class="p">}</span>
</code></pre></div></div>

<h4 id="xor">XOR</h4>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">tf</span><span class="p">(</span><span class="n">ll</span> <span class="o">&amp;</span><span class="n">l</span><span class="p">,</span> <span class="n">ll</span> <span class="o">&amp;</span><span class="n">r</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ll</span> <span class="n">tl</span> <span class="o">=</span> <span class="n">l</span> <span class="o">+</span> <span class="n">r</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">l</span> <span class="o">-</span> <span class="n">r</span><span class="p">;</span>
	<span class="n">l</span> <span class="o">=</span> <span class="n">tl</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">tr</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">utf</span><span class="p">(</span><span class="n">ll</span> <span class="o">&amp;</span><span class="n">l</span><span class="p">,</span> <span class="n">ll</span> <span class="o">&amp;</span><span class="n">r</span><span class="p">)</span> <span class="p">{</span> <span class="n">tf</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">),</span> <span class="n">l</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">r</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span>
</code></pre></div></div>

<h4 id="xnornandnor">XNORã€NANDã€NOR</h4>

<p>ç›´æ¥ç”¨å¼‚æˆ–è¿ç®—ã€ä¸è¿ç®—ã€æˆ–è¿ç®—çš„æ–¹æ³•æ±‚å‡ºæ¥ï¼Œç„¶åå°†äº’åçš„ä¸¤ä½äº¤æ¢å³å¯ã€‚</p>

<h2 id="pell-æ–¹ç¨‹">Pell æ–¹ç¨‹</h2>

<p>å½¢å¦‚$x^2-Dy^2=1$ï¼ˆD ä¸ºä»»æ„æ­£æ•´æ•°ï¼‰çš„æ–¹ç¨‹ç§°ä¸ºä½©å°”æ–¹ç¨‹ï¼Œå¿…æœ‰æœ€å°æ­£æ•´æ•°è§£$(x_0,y_0)$ï¼Œç”¨</p>

<p>$x_n=x_0x_{n-1}+Dy_0y_{n-1},y_n=y_0x_{n-1}+x_0y_{n-1}$</p>

<p>å¯é€’æ¨æ–¹ç¨‹çš„ç¬¬ n å°æ•´æ•°è§£ï¼ˆå¯ç”¨çŸ©é˜µå¿«é€Ÿå¹‚æ±‚ï¼‰ï¼ŒåŒæ—¶è¿˜æœ‰</p>

<p>$2x_0x_n=x_{n-1}+x_{n+1},2x_0y_n=y_{n-1}+y_{n+1}$</p>

<h2 id="bertrand-çŒœæƒ³">Bertrand çŒœæƒ³</h2>

<p>$\forall n&gt;3,\exist n&lt;p&lt;n\times 2$å…¶ä¸­ n ä¸ºæ•´æ•°ï¼Œp ä¸ºè´¨æ•°ã€‚</p>

<h2 id="å¨å°”é€Šå®šç†">å¨å°”é€Šå®šç†</h2>

<p>å½“ä¸”ä»…å½“ p ä¸ºç´ æ•°æ—¶ï¼š$(p-1)!\equiv -1\pmod p$ï¼Œ</p>

<h2 id="jacobis-four-square-theorem">Jacobiâ€™s Four Square Theorem</h2>

<p>è®¾$a^2+b^2+c^2+d^2=n$çš„è‡ªç„¶æ•°è§£ä¸ªæ•°ä¸º$r4(n)$ï¼Œ$d(n)$ä¸º$n$çš„çº¦æ•°å’Œï¼Œç”± Jacobiâ€™s Four Square Theorem å¯çŸ¥ï¼Œè‹¥$n$æ˜¯å¥‡æ•°ï¼Œåˆ™$r4(n)=8d(n)$ï¼Œå¦åˆ™$r4(n)=24d(k)$ï¼Œ$k$æ˜¯$n$å»é™¤æ‰€æœ‰$2$åçš„ç»“æœã€‚</p>
:ET
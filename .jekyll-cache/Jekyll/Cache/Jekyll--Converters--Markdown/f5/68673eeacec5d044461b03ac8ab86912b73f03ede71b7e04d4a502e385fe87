I"j<h2 id="ç»„åˆæ•°å–æ¨¡">ç»„åˆæ•°å–æ¨¡</h2>

<p><a href="https://vjudge.net/solution/18275045">ä½¿ç”¨ç¤ºä¾‹</a></p>

<p>ä¸ºæ–¹ä¾¿ï¼Œè®°$C(n,m)=C_n^m=\binom{n}{m}$ã€‚</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="nc">Factorial</span> <span class="o">:</span> <span class="n">Mod</span>
<span class="p">{</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">fac</span><span class="p">,</span> <span class="n">ifac</span><span class="p">;</span>
	<span class="n">Factorial</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span> <span class="n">ll</span> <span class="n">M</span><span class="p">)</span> <span class="o">:</span> <span class="n">fac</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">ifac</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Mod</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">fac</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">fac</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">),</span> <span class="n">ifac</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">M</span> <span class="o">-</span> <span class="n">M</span> <span class="o">/</span> <span class="n">i</span><span class="p">,</span> <span class="n">ifac</span><span class="p">[</span><span class="n">M</span> <span class="o">%</span> <span class="n">i</span><span class="p">]);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">ifac</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">ifac</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ifac</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]);</span>
	<span class="p">}</span>
	<span class="n">ll</span> <span class="n">c</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">int</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">mul</span><span class="p">(</span><span class="n">mul</span><span class="p">(</span><span class="n">fac</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">ifac</span><span class="p">[</span><span class="n">m</span><span class="p">]),</span> <span class="n">ifac</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="n">m</span><span class="p">]);</span> <span class="p">}</span>
	<span class="n">ll</span> <span class="n">lucas</span><span class="p">(</span><span class="n">ll</span> <span class="n">n</span><span class="p">,</span> <span class="n">ll</span> <span class="n">m</span><span class="p">)</span> <span class="c1">//å¢å¡æ–¯å®šç†æ±‚C(n,m)%Mï¼Œé€‚ç”¨äºæ¨¡æ•°Må°äºNçš„æƒ…å†µï¼Œæˆ–è€…mè¾ƒå°çš„æ—¶å€™ä¹Ÿå¯ä»¥æš´åŠ›æ±‚</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">m</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="o">||</span> <span class="n">n</span> <span class="o">%</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="o">%</span> <span class="n">M</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="n">M</span> <span class="o">&amp;&amp;</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="n">M</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">c</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">mul</span><span class="p">(</span><span class="n">lucas</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">M</span><span class="p">,</span> <span class="n">m</span> <span class="o">/</span> <span class="n">M</span><span class="p">),</span> <span class="n">lucas</span><span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="n">M</span><span class="p">,</span> <span class="n">m</span> <span class="o">%</span> <span class="n">M</span><span class="p">));</span>
	<span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ç»„åˆæ•°-lcm">ç»„åˆæ•° LCM</h2>

<p>$(n + 1)lcm(C(n,0),C(n,1),\ldots,C(n,k))=lcm(n+1,n,nâˆ’1,nâˆ’2,\ldots,nâˆ’k+1)$</p>

<p>åŒºé—´ lcm çš„ç»´æŠ¤ï¼šå¯¹äºä¸€ä¸ªæ•°ï¼Œå°†å…¶åˆ†è§£è´¨å› æ•°ï¼Œè‹¥æœ‰å› å­$p^k$ï¼Œé‚£ä¹ˆæ‹†åˆ†å‡º k ä¸ªæ•° $p^1,p^2,\ldots,p^k$ï¼Œæƒå€¼éƒ½ä¸º pï¼Œé‚£ä¹ˆåŒºé—´$[l,r]$å†…æ‰€æœ‰æ•°çš„ lcm çš„ç­”æ¡ˆ=æ‰€æœ‰åœ¨è¯¥åŒºé—´ä¸­å‡ºç°è¿‡çš„æ•°çš„æƒå€¼ä¹‹ç§¯ï¼Œå¯æŒä¹…åŒ–çº¿æ®µæ ‘ç»´æŠ¤ä¹‹ã€‚</p>

<h2 id="stirling-æ•°">Stirling æ•°</h2>

<h3 id="ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°">ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°</h3>

<p>ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°$S(p,k)$çš„ä¸€ä¸ªçš„ç»„åˆå­¦è§£é‡Šæ˜¯ï¼šå°† p ä¸ªç‰©ä½“æ’æˆ k ä¸ªéç©ºå¾ªç¯æ’åˆ—çš„æ–¹æ³•æ•°ã€‚</p>

<p>é€’æ¨å…¬å¼ï¼š$S(p,k)=(pâˆ’1)S(pâˆ’1,k)+S(pâˆ’1,kâˆ’1),1\leq k\leq pâˆ’1;S(p,0)=0,p\ge1;S(p,p)=1,p\ge0$</p>

<h3 id="ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°">ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°</h3>

<p>ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°$S(p,k)$çš„ä¸€ä¸ªçš„ç»„åˆå­¦è§£é‡Šæ˜¯ï¼šå°† p ä¸ªç‰©ä½“åˆ’åˆ†æˆ k ä¸ªéç©ºä¸å¯è¾¨åˆ«çš„ï¼ˆå¯ä»¥ç†è§£ä¸ºç›’å­æ²¡æœ‰ç¼–å·ï¼‰é›†åˆçš„æ–¹æ³•æ•°ã€‚</p>

<p>é€’æ¨å…¬å¼ï¼š$S(p,k)=kS(pâˆ’1,k)+S(pâˆ’1,kâˆ’1),1\leq k\leq pâˆ’1;S(p,0)=0,p\ge 1;S(p,p)=1,p\ge0$</p>

<p>å·ç§¯å½¢å¼ï¼š$S(n,m)=\frac{1}{m!}\sum_{k=0}^m(-1)^kC(m,k)(m-k)^n=\sum_{k=0}^m\frac{(-1)^k}{k!}\frac{(m-k)^n}{(m-k)!}$</p>

<p>åŒæ—¶æœ‰è½¬åŒ–ï¼š$x^k=\sum_{i=1}^ki!C(x,i)S(k,i)$</p>

<h3 id="æ–¯ç‰¹æ—è¿‘ä¼¼å…¬å¼">æ–¯ç‰¹æ—è¿‘ä¼¼å…¬å¼</h3>

<p>$n!\approx\sqrt{2\pi n}(\frac{n}{e})^n$</p>

<h2 id="å°çƒå…¥ç›’æ¨¡å‹é€šè§£">å°çƒå…¥ç›’æ¨¡å‹é€šè§£</h2>

<table>
  <thead>
    <tr>
      <th>k ä¸ªçƒ</th>
      <th>m ä¸ªç›’å­</th>
      <th>ç©ºç›’å­</th>
      <th>æ–¹æ¡ˆæ•°</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>å„ä¸ç›¸åŒ</td>
      <td>å„ä¸ç›¸åŒ</td>
      <td>å…è®¸</td>
      <td>$m^k$</td>
    </tr>
    <tr>
      <td>å„ä¸ç›¸åŒ</td>
      <td>å„ä¸ç›¸åŒ</td>
      <td>æ— </td>
      <td>$m!Stirling2(k,m)$</td>
    </tr>
    <tr>
      <td>å„ä¸ç›¸åŒ</td>
      <td>å®Œå…¨ç›¸åŒ</td>
      <td>å…è®¸</td>
      <td>$\sum_{i=1}^mStirling2(k,i)$</td>
    </tr>
    <tr>
      <td>å„ä¸ç›¸åŒ</td>
      <td>å®Œå…¨ç›¸åŒ</td>
      <td>æ— </td>
      <td>$Stirling2(k,m)$</td>
    </tr>
    <tr>
      <td>å®Œå…¨ç›¸åŒ</td>
      <td>å„ä¸ç›¸åŒ</td>
      <td>å…è®¸</td>
      <td>$C(m+kâˆ’1,k)$</td>
    </tr>
    <tr>
      <td>å®Œå…¨ç›¸åŒ</td>
      <td>å„ä¸ç›¸åŒ</td>
      <td>æ— </td>
      <td>$C(kâˆ’1,mâˆ’1)$</td>
    </tr>
    <tr>
      <td>å®Œå…¨ç›¸åŒ</td>
      <td>å®Œå…¨ç›¸åŒ</td>
      <td>å…è®¸</td>
      <td>$\frac{1}{(1âˆ’x)(1âˆ’x^2)â€¦(1âˆ’x^m)}çš„x^ké¡¹çš„ç³»æ•°$</td>
    </tr>
    <tr>
      <td>å®Œå…¨ç›¸åŒ</td>
      <td>å®Œå…¨ç›¸åŒ</td>
      <td>æ— </td>
      <td>$\frac{x^m}{(1âˆ’x)(1âˆ’x^2)â€¦(1âˆ’x^m)}çš„x^ké¡¹çš„ç³»æ•°$</td>
    </tr>
  </tbody>
</table>

<h2 id="ç½®æ¢">ç½®æ¢</h2>

<p><a href="https://vjudge.net/solution/18445975">ä½¿ç”¨ç¤ºä¾‹</a></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="nc">Permutation</span> <span class="o">:</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span>
<span class="p">{</span>
	<span class="n">Permutation</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{}</span>
	<span class="k">friend</span> <span class="n">Permutation</span> <span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="k">const</span> <span class="n">Permutation</span> <span class="o">&amp;</span><span class="n">f</span><span class="p">,</span> <span class="k">const</span> <span class="n">Permutation</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">Permutation</span> <span class="n">ans</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">f</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">g</span><span class="p">[</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
		<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">friend</span> <span class="n">Permutation</span> <span class="n">inv</span><span class="p">(</span><span class="k">const</span> <span class="n">Permutation</span> <span class="o">&amp;</span><span class="n">f</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">Permutation</span> <span class="n">ans</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">f</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">ans</span><span class="p">[</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
		<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">friend</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">cycle</span><span class="p">(</span><span class="k">const</span> <span class="n">Permutation</span> <span class="o">&amp;</span><span class="n">f</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">vis</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="mi">0</span><span class="p">);</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">ans</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">f</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
			<span class="p">{</span>
				<span class="n">ans</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">());</span>
				<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">j</span><span class="p">];</span> <span class="n">j</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
					<span class="n">vis</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ans</span><span class="p">.</span><span class="n">back</span><span class="p">().</span><span class="n">push_back</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="ç”Ÿæˆå­—å…¸åº">ç”Ÿæˆå­—å…¸åº</h2>

<h3 id="ä¸‹ä¸€æ’åˆ—">ä¸‹ä¸€æ’åˆ—</h3>

<p>å¯¹ç»™å®šçš„æ’åˆ—$a_1a_2\ldots a_n$ï¼Œæ‰¾åˆ°$a_j$ä½¿å¾—$a_j&lt;a_{j+1},a_{j+1}&gt;a_{j+2}&gt;\ldots&gt;a_n$å³è¿™åˆ—æ•°ä¸­æœ€åä¸€ä¸ªç›¸é‚»é€’å¢æ•°å¯¹ï¼Œç„¶åæŠŠ$a_{j+1},a_{j+2},\ldots,a_n$ä¸­å¤§äº$a_j$çš„æœ€å°æ•°æ”¾åˆ°ä½ç½® jï¼Œç„¶å$a_j\ldots a_n$ä¸­å‰©ä½™çš„æ•°ä»å°åˆ°å¤§æ’åºæ”¾åˆ°$[j+1,n]$ä¸­ã€‚</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">bool</span> <span class="nf">nextPermutation</span><span class="p">(</span><span class="n">ll</span> <span class="o">*</span><span class="n">b</span><span class="p">,</span> <span class="n">ll</span> <span class="o">*</span><span class="n">e</span><span class="p">)</span> <span class="c1">//æ ‡å‡†åº“æœ‰è¿™ä¸ªå‡½æ•°next_permutation</span>
<span class="p">{</span>
	<span class="n">ll</span> <span class="o">*</span><span class="n">i</span> <span class="o">=</span> <span class="n">e</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="n">j</span> <span class="o">=</span> <span class="n">e</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;=</span> <span class="n">b</span> <span class="o">&amp;&amp;</span> <span class="o">*</span><span class="n">j</span> <span class="o">&gt;=</span> <span class="o">*</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
		<span class="o">--</span><span class="n">j</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="o">*</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
		<span class="o">--</span><span class="n">i</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">swap</span><span class="p">(</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="o">*</span><span class="n">j</span><span class="p">),</span> <span class="n">reverse</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="p">),</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="äºŒé¡¹å¼åæ¼”">äºŒé¡¹å¼åæ¼”</h2>

<p>$f(n)=\sum_{k=0}^nC(n,k)g(k),g(n)=\sum_{k=0}^n(âˆ’1)^{nâˆ’k}C(n,k)f(k)$</p>

<h2 id="ç¬¬-k-å°æœŸæœ›">ç¬¬ k å°æœŸæœ›</h2>

<p>$f(n,k)$è¡¨ç¤ºæœ‰ n ä¸ªå˜é‡ï¼Œå’Œä¸º 1ï¼Œç¬¬ k å°çš„æœŸæœ›ã€‚</p>

<p>$f(n,k)=\frac{1}{n^2}+(1-\frac{1}{n})f(n-1,k-1),f(n,0)=0$</p>

<h2 id="é”™æ’æ•°">é”™æ’æ•°</h2>

<p>è€ƒè™‘ä¸€ä¸ªæœ‰ n ä¸ªå…ƒç´ çš„æ’åˆ—ï¼Œè‹¥ä¸€ä¸ªæ’åˆ—ä¸­æ‰€æœ‰çš„å…ƒç´ éƒ½ä¸åœ¨è‡ªå·±åŸæ¥çš„ä½ç½®ä¸Šï¼Œé‚£ä¹ˆè¿™æ ·çš„æ’åˆ—å°±ç§°ä¸ºåŸæ’
åˆ—çš„ä¸€ä¸ªé”™æ’ã€‚</p>

<p>n ä¸ªå…ƒç´ çš„é”™æ’æ•°$D_n$æ»¡è¶³é€’æ¨å…¬å¼ï¼š$D_1=0,D_2=1,D_n=(nâˆ’1)(D_{nâˆ’2}+D_{nâˆ’1})$</p>

<p>é€šé¡¹ï¼š$D(n)=n![\frac{(-1)^2}{2!}+\ldots+\frac{(-1)^{n-1} }{(n-1)!}+\frac{(-1)^n}{n!}]=\lfloor\frac{n!}{e}+\frac{1}{2}\rfloor$</p>

<h2 id="bonuli-æ•°">Bonuli æ•°</h2>

<p><a href="http://www.51nod.com/Challenge/ProblemSubmitDetail.html#!#judgeId=744601">ä½¿ç”¨ç¤ºä¾‹</a></p>

<p>$B_n = -\frac{1}{C(n+1,n)}(C(n+1,0)B_0+C(n+1,1)B_1+\ldots+C(n+1,n-1)B_{n-1})=-\frac{1}{n+1}(C(n+1,0)B_0+C(n+1,1)B_1+\ldots+C(n+1,n-1)B_{n-1})$</p>

<p>å¯ç”¨äºè®¡ç®—ä»»æ„<strong>æ­£æ•´æ•°</strong>æ¬¡æ•°çš„å¹‚å’Œï¼š$\sum_{i=1}^ni^k=\frac{1}{k+1}\sum_{j=0}^kC(k+1,j)B_jn^{k+1-j}$</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="nc">Bonuli</span> <span class="o">:</span> <span class="n">Factorial</span>
<span class="p">{</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">b</span><span class="p">;</span>
	<span class="n">Bonuli</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">,</span> <span class="n">ll</span> <span class="n">M</span><span class="p">)</span> <span class="o">:</span> <span class="n">Factorial</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">),</span> <span class="n">b</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
				<span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">qadd</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mul</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">c</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">)));</span>
			<span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">qadd</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="o">-</span><span class="n">mul</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mul</span><span class="p">(</span><span class="n">fac</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ifac</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])));</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">ll</span> <span class="n">ask</span><span class="p">(</span><span class="n">ll</span> <span class="n">n</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">ll</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">r</span> <span class="o">=</span> <span class="n">qadd</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">mul</span><span class="p">(</span><span class="n">mul</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">)),</span> <span class="n">w</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">u</span><span class="p">)));</span>
		<span class="k">return</span> <span class="n">mul</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">mul</span><span class="p">(</span><span class="n">fac</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ifac</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]));</span>
	<span class="p">}</span>
<span class="p">};</span>

</code></pre></div></div>

<h2 id="catalan-æ•°">Catalan æ•°</h2>

<p>$h_1=1,h_n=\frac{4nâˆ’2}{n+1}h_{nâˆ’1}=\frac{C(2n,n)}{n+1}=C(2n,n)âˆ’C(2n,nâˆ’1)$ã€‚</p>

<p>åœ¨ä¸€ä¸ªæ ¼ç‚¹é˜µåˆ—ä¸­ï¼Œä»$(0,0)$ç‚¹èµ°åˆ°$(n,m)$ç‚¹ä¸”ä¸ç»è¿‡å¯¹è§’çº¿$x=y$çš„æ–¹æ³•æ•°ï¼š$C(n+mâˆ’1,m)âˆ’C(n+mâˆ’1,mâˆ’1),x&gt;y;C(n+m,m)âˆ’C(n+m,mâˆ’1),x\ge y$ã€‚</p>

<p>å¸¸è§çš„ Catalan æ•°ï¼šæ‹¬å·åºçš„ä¸ªæ•°ã€å‡¸å¤šè¾¹å½¢ä¸‰è§’å‰–åˆ†çš„æ–¹æ¡ˆæ•°ç­‰ã€‚</p>

<h2 id="bell-æ•°">Bell æ•°</h2>

<p>æŠŠ n ä¸ªå¸¦æ ‡å·çš„ç‰©å“åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ç›¸äº¤é›†åˆçš„æ–¹æ¡ˆæ•°ç§°ä¸ºè´å°”æ•°ï¼Œå…¶é€’æ¨å…¬å¼ï¼š$B_n=\sum_{i=0}^{N-1}C_{n-1}^iB_i$</p>

<p>å‰å‡ é¡¹è´å°”æ•°ï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1,2,5,15,52,203,877,4140,21147,115975,678570,4213597,27644437,190899322,1382958545,...
</code></pre></div></div>

<h3 id="ç­‰ä»·ç±»å®¹æ–¥">ç­‰ä»·ç±»å®¹æ–¥</h3>

<p>è€ƒè™‘å®¹æ–¥ï¼ŒBell(p)æšä¸¾æ‰€æœ‰ç­‰ä»·æƒ…å†µã€‚å¯¹äºä¸€ç§æƒ…å†µï¼Œå¼ºåˆ¶äº†ä¸€ä¸ªç­‰ä»·ç±»é‡Œé¢çš„æ•°éƒ½è¦ç›¸åŒï¼Œå…¶å®ƒçš„å¯ä»¥ç›¸åŒä¹Ÿå¯ä»¥ä¸åŒã€‚</p>

<p>å®¹æ–¥ç³»æ•°ä¸ºï¼š$(âˆ’1)^{pâˆ’ç­‰ä»·ç±»ä¸ªæ•°}(æ¯ä¸ªç­‰ä»·ç±»å¤§å°âˆ’1)!ä¹‹ç§¯$ã€‚</p>

<h2 id="grey-ç ">Grey ç </h2>

<p>æ ¼é›·åºåˆ—ç¬¬ i ä¸ªæ˜¯<code class="language-plaintext highlighter-rouge">i^(i&gt;&gt;1)</code>ã€‚é•¿ä¸º n çš„ 01 åºåˆ—å…±$2^n$ä¸ªï¼Œä¸‹æ ‡ä»$0\ldots 2^n-1$ã€‚</p>

<h2 id="æ‰©å±•-cayley-å…¬å¼">æ‰©å±• Cayley å…¬å¼</h2>

<p>å¯¹äº n ä¸ªç‚¹ï¼Œm ä¸ªè¿é€šå—çš„å›¾ï¼Œå‡è®¾æ¯ä¸ªè¿é€šå—æœ‰ a[i]ä¸ªç‚¹ï¼Œé‚£ä¹ˆç”¨ sâˆ’1 æ¡è¾¹æŠŠå®ƒè¿é€šçš„æ–¹æ¡ˆæ•°ä¸º$n^{sâˆ’2}a[1]a[2]\ldots a[m]$ã€‚</p>

<h2 id="è¶…ç«‹æ–¹ä½“">è¶…ç«‹æ–¹ä½“</h2>

<p>n ç»´è¶…ç«‹æ–¹ä½“æœ‰$2^{nâˆ’i}C(n,i)$ä¸ª i ç»´å…ƒç´ ã€‚</p>

<h2 id="æšä¸¾ä½é›†-i-çš„éç©ºå­é›†-j">æšä¸¾ä½é›† I çš„éç©ºå­é›† J</h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span><span class="p">(</span><span class="n">J</span><span class="o">=</span><span class="n">I</span><span class="p">;</span> <span class="n">J</span><span class="p">;</span> <span class="n">J</span><span class="o">=</span><span class="n">I</span><span class="o">&amp;</span><span class="n">J</span><span class="err">âˆ’</span><span class="mi">1</span><span class="p">)</span> <span class="p">{}</span>
</code></pre></div></div>
:ET